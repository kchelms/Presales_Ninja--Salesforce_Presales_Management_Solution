<template>
    <lightning-record-view-form record-id={opportunityId} object-api-name="Opportunity"></lightning-record-view-form>
        <lightning-card title="Request a Presales Activity" >
            <div class="slds-var-p-around_medium">
            
            <!--Search Products..add and remove -->
            <div class="search-table search-wrapper">
                <abbr title="required" class="slds-required">*</abbr>
                <label for="date1" class="slds-text-title" >Product(s)</label>
                <lightning-input class="search" label="Product" type="search" id="search" variant="label-hidden" onchange={productSelector.searchEvt} ></lightning-input>
                <ul class="slds-var-m-around_medium">
                    <template for:each={filteredProducts} for:item="product">
                        <li key={product.external_product_ID}>
                            {product.name}
                            <lightning-button   value={product} 
                                                variant="success" 
                                                label="Add" 
                                                title="Successful action" 
                                                onclick={productSelector.addProd} 
                                                class="slds-var-m-left_x-small">
                            </lightning-button>
                        </li>
                    </template>

                    <template for:each={selectedProducts} for:item="prod">
                        <li key={prod.external_product_ID}>
                            {prod.name}
                            <lightning-button   value={prod} 
                                                variant="destructive" 
                                                label="Remove" 
                                                title="Destructive action" 
                                                onclick={productSelector.removeProd} 
                                                class="slds-var-m-left_x-small">
                            </lightning-button>
                        </li>
                    </template>
                </ul>
            </div>

            <div class="slds-grid slds-gutters_xx-small">
            
                <lightning-combobox name="activity_type" 
                                    label="Activity Type"
                                    placeholder="Select activity type" 
                                    options={activityTypes}
                                    class="slds-col slds-size_3-of-5"
                                    onchange={selectActivityType} 
                                    required >
                </lightning-combobox>

                <lightning-combobox name="activity_level" 
                                    label="Activity Level" 
                                    placeholder="Select activity level" 
                                    options={activityLevels}
                                    class="slds-col slds-size_2-of-5" 
                                    onchange={selectActivityLevel} 
                                    required >
                </lightning-combobox>

            </div>

            <lightning-combobox name="location" 
                                label="Location" 
                                value={location} 
                                options={locationOptions} 
                                class="slds-var-p-top_small slds-var-p-bottom_small" 
                                onchange={setLocation} >
            </lightning-combobox>

            <abbr title="required" class="slds-required">*</abbr>
            <label for="date1" class="slds-text-title" >Date</label>
            <lightning-input type="datetime" label=" " data-item="date1" variant="label-hidden" onchange={dateInputHandler} required></lightning-input>

            <template if:false={alternateDates}>
                <lightning-button variant="base" label="Add Alternate Dates" class="slds-align_absolute-center" onclick={showAlternateDates}></lightning-button>
            </template>

            <template if:true={alternateDates}>
                <lightning-input type="datetime" label=" " data-item="date2" variant="label-hidden" class="slds-var-p-top_small" onchange={dateInputHandler} ></lightning-input>
                <lightning-input type="datetime" label=" " data-item="date3" variant="label-hidden" class="slds-var-p-top_small" onchange={dateInputHandler} ></lightning-input>
                <lightning-button variant="base" label="Hide Alternate Dates" class="slds-align_absolute-center" onclick={showAlternateDates} ></lightning-button>
            </template>

            <!--Text Description-->
            
            <lightning-textarea id="textarea" 
                                label="Notes" 
                                onchange ={updateNotes} >
            </lightning-textarea>
            
            <lightning-input type="checkbox" label="This is an unexpected event" class="slds-var-p-top_small" onchange={setFlag}></lightning-input>
                    

            <!--Submit button class="button"-->
            <lightning-button   variant="submit" 
                                label="Submit" 
                                type="submit" 
                                disabled={isSubmitDisabled} 
                                title="Submit"
                                class="slds-var-p-top_small slds-align_absolute-center"
                                onclick={handleUploadAction} >
            </lightning-button>
        </div>
    </lightning-card>
</template>